<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Users Table</title>
  </head>
  <body>
    <%- include("./navbar.ejs") %>
    <h2>Users Table</h2>
    <table border="2">
      <thead>
        <tr>
          <th>SN</th>
          <th>profile</th>
          <th>Name</th>
          <th>Address</th>
          <th>Phone</th>
          <th>Email</th>
          <th>Is Active</th>
          <th>Role</th>
          <th>Company</th>
          <th>created by</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% data.result.forEach((users,index) => { %>
        <tr>
          <td><%= index + 1 %></td>
          <td>
            <img
              src="<%= users.user_image %>"
              style="width: 50px; height: 50px"
              alt="user profile"
            />
          </td>
          <td><%= users.name %></td>
          <td><%= users.address || 'N/A' %></td>
          <td><%= users.phone || 'N/A' %></td>
          <td><%= users.email %></td>
          <td><%= users.is_active ? 'Yes' : 'No' %></td>
          <td><%= users.roles %></td>
          <td><%= users.company_name %></td>
          <td><%= users.created_by || 'N/A' %></td>

          <td>
            <a class="btn btn-edit" href="/user/edit?id=<%= users.user_id %>"
              >Edit</a
            >
            <form class="deleteuser" style="display: inline">
              <input type="hidden" name="id" value="<%= users.user_id %>" />
              <button
                type="submit"
                onclick="return confirm('Are you sure you want to delete this user');"
              >
                Delete
              </button>
            </form>
          </td>
        </tr>
        <% }) %>
      </tbody>
    </table>
    <% if(data.total_page > 1){%> <% for(let i = 1; i<= data.total_page; i++){%>
    <a href="?page=<%= i %>"><%= i %></a>
    <% } %> <% } %>

    <h2>Change Password</h2>
    <div>
      <!-- Change Password Form -->
      <section class="change-password">
        <form id="changepassword">
          <select name="user_id" id="user_id">
            <option value="" selected>select user</option>
            <% data.result.forEach((users) => { %>
            <option value="<%= users.user_id%>"><%= users.name%>:-<span><%= users.email%></span></option>
            <% }) %>
          </select>
          </div>
          <div class="form-group">
            <label for="new_password">New Password:</label>
            <input
              type="password"
              id="new_password"
              name="new_password"
              placeholder="Enter new password"
              required
            />
          </div>
          <div class="form-group">
            <label for="confirm_password">Confirm New Password:</label>
            <input
              type="password"
              id="confirm_password"
              name="confirm_password"
              placeholder="Confirm new password"
              required
            />
          </div>
          <input type="submit" value="Change Password" />
        </form>
      </section>
    </div>
  </body>
  <script src="/viewuser.js"></script>
</html>
